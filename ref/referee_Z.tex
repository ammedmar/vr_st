\documentclass{amsart}
\input{../aux/style}
\input{../aux/usualcmds}
\addbibresource{../aux/usualpapers.bib}

%%%%%%%%%%%%%%%%%%%%%%
\input{../aux/commands} % add commands here
\addbibresource{../aux/bibliography.bib} % add references here
\usepackage{enumitem}
\setlist{label=\arabic{enumi}.,itemsep=\medskipamount, left=0pt}

%%%%%%%%%%%%%%%%%%%%%%
\title[Referee reply]{\underline{REPLY TO REFEREE Y} \\ Persistent cohomology operations \\ and Gromov--Hausdorff estimates}

\newcommand{\ar}{\medskip\noindent\textit{Reply}:\ }
\renewcommand{\thesection}{\arabic{section}}

\begin{document}
	\noindent\today
	\maketitle

	We would like to thank the reviewer for a careful and insightful analysis of our paper, and for the many suggestions improving its presentation.
	We copy their report for completeness.

	\section{Reviewer's summary}

	This paper introduces considerations of cohomology operations in the theory of persistence.
	More precisely, the authors define the image and the kernel persistence module of a cohomology operation with respect to the Vietoris--Rips filtration of metric spaces.
	These represent more general concepts than the persistence module, as the identity and the trivial cohomology operation, respectively, recover the classical notions.
	The first general results in the paper are formulas for products (Theorem A) and wedge sums (Theorem B) of metric spaces.
	The second main result is a stability theorem (Theorem C), which represents a lower bound on the Gromov--Hausdorff distance between metric spaces by the interleaving distance of the persistence module of the image of a linear cohomology operation.
	Theorem C represents a generalization of stability results by Chazal et al.\ relating the Gromov--Hausdorff distance and the interleaving distance of persistence modules.
	One of the key tools for the proof of Theorem C is the notion of homotopy interleaving distance, due to Blumberg and Lesnick.
	Finally, the authors demonstrate (Theorem D) that their Theorem C yields a sharper lower bound for Gromov--Hausdorff distance than the classical stability result.
	Namely, they provide an example of $\mathbb{RP}^n$ and the wedge of spheres $S^1 \vee \cdots \vee S^n$ (spaces that have isomorphic mod $2$ cohomology groups) for which the new lower bound is improved.

	The paper deals with a very relevant subject and offers interesting new results, improving upon classical results.
	It introduces new concepts that are likely to inspire future work in the area.
	With that said, there are some places in need of corrections and some occasions where more explanation was warranted.
	I would like to see these points be addressed prior to acceptance.

	\section{Reviewer's individual items}

	\begin{enumerate}
		\item Page 6, line $-12$: Address the (non-trivial) fact that the weak equivalence of $\mathbb{R}$-spaces, as defined through a single $\mathbb{R}$-space $W$ (rather than a zig-zag) is an equivalence relation.

		\ar As the referee points out, the transitivity of the relation defined via a single span is not automatic in the naive category of topological spaces.

		In the revised version we now work in the category of compactly generated weak Hausdorff spaces and equip $\Top^\R$ with the projective model structure, whose weak equivalences and fibrations are defined objectwise. Since $\Top$ is a cofibrantly generated model category and $\R$ is small, this model structure exists, and all objects are fibrant.

		In any model category, two objects are weakly equivalent if and only if they are connected by a zig--zag of weak equivalences. Moreover, when all objects are fibrant, this is equivalent to the existence of a span
		\[
		X \xleftarrow{\sim} W \xrightarrow{\sim} Y.
		\]
		We now make this precise in the text and refer to \cite[\S2.4]{blumberg2023interleaving}.

		\medskip
		\begin{quote}
			Let $\Top$ denote the category of compactly generated weak Hausdorff spaces and continuous maps.
			We write $\Top^\R \defeq \Fun(\R,\Top)$ for the category of \defn{$\R$-spaces}--where $\R$ is regarded as a poset category--equipped with the projective model structure in which weak equivalences and fibrations are defined objectwise.
			An $\R$-space $X$ is \defn{cellular} if each $X_r$ is a CW-complex.

			We say that a morphism $f \colon X \to Y$ in $\Top^\R$ is a \defn{weak equivalence} if, for every $r \in \R$, the map $f_r \colon X_r \to Y_r$ is a weak homotopy equivalence.
			Two $\R$-spaces $X$ and $Y$ are \defn{weakly equivalent}, denoted $X \simeq Y$, if they become isomorphic in the homotopy category or, equivalently, $X \simeq Y$ if there exists an $\R$-space $W$ and weak equivalences
			\[
			X \xleftarrow{\ \sim\ } W \xrightarrow{\ \sim\ } Y
			\]
			\cite[\S2.4]{blumberg2023interleaving}.
		\end{quote}

		\item Page 7, line 16: Define $C([0, 1/n])$ and the persistence module.

		\ar Changed as suggested (CAS).

		\item Page 9, \S3.1: For the representability of cohomology, $\pi$ should be abelian.

		\ar Added the missing hypothesis.

		\item Page 12, second paragraph of \S3.3.7: It would be helpful to provide some information about cohomology of $L_q^n$, as this is later used in the proof of Lemma 4.7.

		\ar CAS.

		\item Page 12, second paragraph of \S3.3.7: It would also be helpful to provide more information on the action of $\mathcal{A}_p$, as this is used in \S5.1.1 to show that the round Lens space satisfies Desideratum (3).

		\ar CAS.

		\item Page 14, line 2: The reference for K\"unneth formula for cohomology should be [Hat02, Theorem 3.15] and its assumptions should be included in the statement of Lemma in 3.5.3.

		\ar We changed the first line of the proof to refer to the cohomology K\"unneth formula (Thm.3.15) and make the assumptions of the theorem explicit (CW and free \(R\)-modules).
		It now reads:

		\medskip
		\begin{quote}
			For any \(r \in \R\), the natural projections $X_r \leftarrow X_r \times Y_r \to Y_r$ induce the K\"unneth isomorphism $\rH^*(X_r) \otimes \rH^*(Y_r) \to \rH^*(X_r \times Y_r)$, since we are working with cellular spaces over a field. (\cite[Thm.~3.15]{hatcher2000}).
		\end{quote}

		\item Page 19, \S4.3.3: It would be valuable to provide more details for how Figure 2 is obtained (such as the value $\frac{\pi}{2}\zeta_n$ on the $x$-axis), since it is crucial in \S5.

		\ling{Please help me check if this provides enough details.}

		\ar The $x$-axis values are $\frac{\pi}{2}$ and $\zeta_n$ seperately, not multiplied. To avoid confusion, we removed the value $\frac{\pi}{2}$ from the $x$-axis of the subfigures.
		Also, we provide more details on how the figure is obtained, as follows:

		\smallskip

		At the end of \S4.3.3, we now clarify that the barcode of a single sphere
		is the special case of Figure~2 by adding the following phrase:

		\begin{quote}
			we proceed with $\dots$,
			corresponding to $u_n=1$ and $u_i=0$ for $i\neq n$.
		\end{quote}

		\smallskip

		At the end of \textsection 4.3.4, we add the following sentences:

		\begin{quote}
			In particular, each $m$-sphere summand contributes a bar $(0,\zeta_m)$
			to $\Hbarc[\field]{m}{\VS^{u_1,\dots,u_n}}$,
			and this occurs with multiplicity $u_m$.
			Since $\zeta_1 > \dots > \zeta_n$,
			the smallest threshold $\zeta_n$ determines the vertical dashed line
			in Figure~2.
		\end{quote}

		\item Page 20, line $-6$: $G$ should act by isometries on $X$ in order for $g \cdot \sum \lambda_i x_i \in \mathrm{VR}_r(X)$ and should moreover act properly on $X$ in order for $X/G$ to have the quotient metric.

		\ar Added the missing assumptions to the beginning of that subsection (4.4.2).

		\item Page 20, line $-2$: The induced map $\tilde{h}_r$ goes in the opposite direction. Namely, the quotient $X \to X/G$ induces a map $\mathrm{VR}(X) \to \mathrm{VR}(X/G)$, which is $G$-invariant, hence factors through $\mathrm{VR}(X)/G \to \mathrm{VR}(X/G)$. This affects some arguments later. For example, the definition of the map $\rho_{j-1}$ in the proof of Lemma 4.5.4 should use the inverse of $\tilde{h}_r$ under the assumption of a strong $r$-diameter action.

		\ar \anibal{I think this seems pretty serious. Can you take a close look, please?}

		\item Page 21, line $-9$ (proof of Lemma 4.4.3): It seems that the bound
		\[
		d_S(\omega^b x_j^*, \omega^{b-1} x_j^*) < r
		\]
		is used, but
		\[
		d_S(\omega^b x_j^*, \omega^{b-1} x_j^*) = d_S(\omega x_j^*, x_j^*) = \frac{2\pi}{q}.
		\]

		\ar We thank the referee for pointing out the gap in the proof. We have followed the suggestion of another referee and modified the proof as follows to fill the gap:

		\medskip
		\begin{quote}
			We claim that $d_{\bS}(x_i^*, x_j^*) < r$ for all $1 \le i,j \le k$.
			If this is not the case, then there exist indices $i,j$ and $1 \leq a \leq q-1$ such that $d_{\bS}(x_i^*, \omega^a x_j^*) < r$.
			Applying the triangle inequality to $x_i^*, x_j^*$ and $x_0$, we have
			\[d_{\bS}(x_i^*, x_j^*) \leq d_{\bS}(x_i^*, x_0) + d_{\bS}(x_0, x_j^*) < 2r.\]
			On the other hand, applying the triangle inequality to $x_i^*, x_j^*$ and $\omega^a x_j^*$, we have
			\[
			d_{\bS}(x_i^*, x_j^*) \geq d_{\bS}(x_j^*, \omega^a x_j^*) - d_{\bS}(x_i^*, \omega^a x_j^*) > \frac{2\pi}{q} - r,
			\]
			given $1 \leq a \leq q-1$.
			Combining the above two inequalities, since $q \geq 2$, we have
			\[
			2r > \frac{2\pi}{q} - r \implies r > \frac{2\pi}{3q} \geq \frac{2\pi}{q(q+1)},
			\]
			which contradicts the assumption $r \le \frac{2\pi}{q(q+1)}$.
			Thus, $d_{\bS}(x_i^*, x_j^*) < r$ holds for all $1 \le i,j \le k$, completing the proof of the claim.
		\end{quote}

		\item Page 23, line 1: A reference should be provided for the (non-trivial) fact that $f_r^n$, being a homotopy equivalence and a $C_2$-equivariant map between free $C_2$-spaces, induces a homotopy equivalence on the orbit spaces.

		\ar We spelled out the proof of this fact with relevant refereces to Hatcher.
		It now reads:

		\medskip
		\begin{quote}
			Because the \(\cyc_2\)-action is proper and free, the quotient maps to the orbit spaces are covering space projections \cite[Prop.~1.40]{hatcher2000}.
			These projections induce isomorphisms on \(\pi_k\) for \(k \ge 2\) \cite[Prop.~4.1]{hatcher2000}, which, combined with the \(\cyc_2\)-equivariance of $f_r^n$, forces the induced map on the orbit spaces to also be an isomorphism for \(k \ge 2\).
			For \(k=1\), a diagram chase in the short exact sequences of groups of the covering spaces ensures an isomorphism on fundamental groups.
			Together with a natural bijection on path components, this establishes that the induced map on the orbit spaces is a weak equivalence.
		\end{quote}

		\item Page 23, Lemma 4.5.4: It is needed to assume (or ensure) that $S^n_i/G$ is an orientable Riemannian manifold (with respect to the relevant coefficient field, which is not mentioned) in order to consider its filling radius. Moreover, throughout \S4--6 the use of coefficients should be pointed out more explicitly.

		\anibal{I think this is an important observation. Is the key lemma holding for any field \(\k\)? Are we making any claims about the original \(\Z\)-coeff radius?}

		\item Page 23, proof of Lemma 4.5.4: There is a factor of $2$ missing for the scale parameter in the index of $\mathrm{VR}$ throughout the proof, since filling radius (and other radii) are defined in terms of $U_r(X) \simeq \mathrm{VR}_{2r}(X)$.

		\item Page 23, diagram (5): The bottom-right slot could be replaced with a smaller space $\mathrm{VR}_{\delta_{j-1} + \varepsilon}(X_j)$ (then, the right vertical map would not witness the change of the scale parameter) and the whole proof would go unchanged. This would yield a stronger bound $\beta_j^i \le \delta_{j-1}$, for $1 \le i \le j-1$.

		\item Page 23, diagram (6): It would be helpful to include an explanation for why the left vertical map
		\[
		H^{n_i}(X_{j-1}) \to H^{n_i}(X_j)
		\]
		is an isomorphism.

		\item Page 25, line $-9$: It would be good to provide more explanation for the fact that $\operatorname{Rad}_m(L_q^n) = 0$, for $m$ even.

		\anibal{I think this is because we are working with \(\Fp\) coefficients implicitly, but we never say that. Do you think it would be a good idea to always add the coefficients to critical radii?}

		\item Page 26, \S5.1.1: It would be helpful to provide more details for the fact that real projective spaces satisfy Desiderata, as this is the crucial step later in \S5.2.

		\ar We take the suggestion and now include the following detailed proof:

		\medskip
		\begin{quote}
			We verify that the round real projective spaces of radius \(\pi\) satisfy these Desiderata.
			Recall that \(\zeta_n = \arccos(\tfrac{-1}{1+n})\) and, from \cref{s:critical_radii_rpn}, that \(\crit(\rp^n) = \tfrac{\pi}{3}\).
			For \(n \geq 1\) we have \(\crit(\rp^n) \geq \tfrac{\zeta_n}{2}\) since
			\[
			\tfrac{1}{2} \geq \tfrac{1}{1+n} \ \Leftrightarrow \
			\tfrac{-1}{2} \leq \tfrac{-1}{1+n} \ \Leftrightarrow \
			\arccos \tfrac{-1}{2} \geq \arccos\tfrac{-1}{1+n} \ \Leftrightarrow \
			\tfrac{2\pi}{3} \geq \zeta_n.
			\]

			Let us now focus on Desideratum~(2).
			For any integers $k \geq 1$ we have $\frac{-1}{1+k} < 0$.
			Because \(\arccos\) is decreasing, it follows that for any $k \geq 1$,
			\[
			\zeta_k = \arccos\left(\frac{-1}{1+k}\right) > \arccos(0) = \frac{\pi}{2}.
			\]
			Using this strict lower bound for both $\zeta_n$ and $\zeta_m$, we obtain:
			\[
			\frac{\zeta_n}{4} + \frac{\zeta_m}{2} > \frac{1}{4}\left(\frac{\pi}{2}\right) + \frac{1}{2}\left(\frac{\pi}{2}\right) = \frac{\pi}{8} + \frac{\pi}{4} = \frac{3\pi}{8} > \frac{\pi}{3}.
			\]
			By \cref{s:critical_radii_rpn} we know that either \(\firstdeath{m}{\rp^n} = \tfrac{\pi}{3}\) or \(\firstdeath{m}{\rp^n} = 0\) from which the above inequality concludes the verification of Desideratum~(2).

			As shown in \cref{s:critical_radii_rpn}, Desideratum~(3) is satisfied by choosing a Steenrod square \(\Sq^k\) and degree \(m < n\) with \(k \leq \frac{n-1}{2} \text{ and } \binom{m-k}{k} \text{ odd}\).
		\end{quote}

		\item Page 26, \S5.1.1: It would also be helpful to provide more details why the round Lens space satisfies Desideratum (3), because \S3.3.7 does not contain that information.

		\ar As suggested by the reviewer earlier, we included now the action of \(\cA_p\) on the cohomology of Lens spaces.
		Therefore, the reference to \S3.3.7 now includes the relevant information.

		\item Page 27, proof of Lemma 5.1.5: It would be helpful to include a short explanation for $\zeta_m - \zeta_n < \frac{\pi}{6}$.

		\ar We have expanded this proof, including the specific point raised by the reviewer.
		It now reads:

		\medskip
		\begin{quote}
			As before, let $\zeta_n = \arccos\!\left(-\tfrac{1}{n+1}\right)$.
			Since $\arccos$ is strictly decreasing on $[-1,1]$ and $-\frac{1}{n+1}$ is increasing in $n$, the sequence $(\zeta_n)_{n\ge 1}$ is strictly decreasing.

			\lemma
			Let $m \leq n$.

			\noindent (1) $\zeta_m - \zeta_n < \tfrac{\pi - \zeta_n}{2} < \tfrac{\zeta_n}{2}$.

			\noindent (2) For any $r \in \big[\zeta_n,\, \tfrac{\zeta_n}{2}+\zeta_m\big)$, $\max\big\{|\zeta_m - r|,\, \tfrac{\pi - \zeta_n}{2}\big\} < \tfrac{\zeta_n}{2}$.

			\medskip
			\begin{proof}
				Since $-\frac{1}{n+1} < 0$, we have $\zeta_n > \arccos(0) = \tfrac{\pi}{2}$.
				Since $(\zeta_n)$ is decreasing and $\zeta_1 = \arccos\!\left(-\tfrac12\right) = \tfrac{2\pi}{3}$, we also have $\zeta_n \le \tfrac{2\pi}{3}$.

				\smallskip
				(1) Because $(\zeta_n)$ is decreasing and $m\le n$, we have $\zeta_m \le \zeta_1$, hence
				$\zeta_m - \zeta_n \le \zeta_1 - \zeta_n < \tfrac{2\pi}{3} - \tfrac{\pi}{2} = \tfrac{\pi}{6}$.
				Since $\zeta_n \le \tfrac{2\pi}{3}$, we have $\tfrac{\pi - \zeta_n}{2} \ge \tfrac{\pi}{6}$, so $\zeta_m - \zeta_n < \tfrac{\pi - \zeta_n}{2}$.
				Moreover $\tfrac{\pi - \zeta_n}{2} < \tfrac{\zeta_n}{2}$ is equivalent to $\zeta_n > \tfrac{\pi}{2}$, which holds.

				\smallskip
				(2) Since $\tfrac{\pi - \zeta_n}{2} < \tfrac{\zeta_n}{2}$ by Part (1), it remains to show $|\zeta_m - r| < \tfrac{\zeta_n}{2}$.
				If $r \in [\zeta_n,\, \zeta_m)$, then $|\zeta_m - r| = \zeta_m - r \le \zeta_m - \zeta_n < \tfrac{\zeta_n}{2}$ by Part (1).
				If $r \in [\zeta_m,\, \zeta_m + \tfrac{\zeta_n}{2})$, then $|\zeta_m - r| = r - \zeta_m < \tfrac{\zeta_n}{2}$ by the upper bound on $r$.
				Thus in all cases $|\zeta_m - r| < \tfrac{\zeta_n}{2}$, and therefore $\max\big\{|\zeta_m - r|,\, \tfrac{\pi - \zeta_n}{2}\big\} < \tfrac{\zeta_n}{2}$.
			\end{proof}
		\end{quote}

		\item Page 28, proof of Theorem 5.2.(1): The regime $m > n$ is currently not included in the proof. It would be good either to include it, or impose assumption $1 \le m \le n$ in the statements of Theorem 5.2.(1) and Theorem D.

		\item Page 28, line $-3$: Please provide more details or a reference for the lower bound for the Gromov--Hausdorff distance obtained via persistence homology, as its improvement is one of the highlights of the paper. It would also be good to include this in the introduction.
	\end{enumerate}

	\section{Other changes}

	\begin{enumerate}
		\item
	\end{enumerate}
\end{document}